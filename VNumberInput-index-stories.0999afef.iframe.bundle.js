(self.webpackChunk_toshusai_app_ui=self.webpackChunk_toshusai_app_ui||[]).push([[626],{"./src/VNumberInput/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,_123:()=>_123,_2x3:()=>_2x3,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("./node_modules/react/index.js"),useNativeOnChange=__webpack_require__("./src/utils/useNativeOnChange.tsx"),getDragHander=__webpack_require__("./src/utils/getDragHander.ts"),StyledInput=__webpack_require__("./src/styled/StyledInput.tsx");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const VNumberInput=props=>{const[isFocused,setIsFocused]=(0,react.useState)(!1),{inputRef,value,setValue}=(0,useNativeOnChange.l)(props.value??0,(value=>{if("string"==typeof value){const v=function parseNumber(value){const isOnlyNumber=/^[0-9.]+$/.test(value);return isOnlyNumber?Number(value):NaN}(value);if(isNaN(v)){const finalValue=function parseString(str,defaultValue){return function isEvalSafe(str){return/^[0-9+\-*/(). ]+$/.test(str)}(str)?function runAsFunction(str){return new Function(`return (${str})`)()}(str):defaultValue}(value,props.value??0);setValue(finalValue),props.onChange?.(finalValue)}else{const value=_minMax(v);props.onChange?.(value),setValue(value)}}else{const v=_minMax(value);props.onChange?.(v)}})),_minMax=(0,react.useCallback)((value=>function minMax(value,min,max){return value<min?min:value>max?max:value}(value,props.min??Number.MIN_SAFE_INTEGER,props.max??Number.MAX_SAFE_INTEGER)),[props.min,props.max]),handleMouseDown=(0,getDragHander.j)((ctx=>{ctx.startEvent.preventDefault();let value=(props.value??0)+ctx.diffX*(props.scale??1);value=_minMax(value),setValue(value),props.onInput?.(value)}),(ctx=>{ctx.startEvent.preventDefault()}),(ctx=>{if(0===ctx.diffX&&0===ctx.diffY)setIsFocused(!0),inputRef.current?.focus(),inputRef.current?.select();else{let value=(props.value??0)+ctx.diffX*(props.scale??1);value=_minMax(value),props.onChange?.(value)}}));return(0,jsx_runtime.jsx)(StyledInput.F,{ref:inputRef,readOnly:!isFocused,value:props.view?props.view(value):value,style:{cursor:isFocused?"default":"ew-resize",userSelect:isFocused?"text":"none"},onMouseDown:handleMouseDown,onChange:e=>{try{const x=parseFloat(e.target.value);if(isNaN(x)||isNaN(e.target.valueAsNumber))throw new Error("NaN");const value=_minMax(e.target.valueAsNumber);props.onInput?.(value),setValue(value)}catch(_){setValue(e.target.value)}},onKeyDown:e=>{"Enter"===e.key&&(setIsFocused(!1),inputRef.current?.blur())},onFocus:()=>{setIsFocused(!0)},onBlur:()=>{setIsFocused(!1)}})};VNumberInput.displayName="VNumberInput";try{VNumberInput.displayName="VNumberInput",VNumberInput.__docgenInfo={description:"",displayName:"VNumberInput",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"number"}},scale:{defaultValue:null,description:"",name:"scale",required:!1,type:{name:"number"}},view:{defaultValue:null,description:"",name:"view",required:!1,type:{name:"((value: number) => string)"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: number) => void)"}},onInput:{defaultValue:null,description:"",name:"onInput",required:!1,type:{name:"((value: number) => void)"}},min:{defaultValue:null,description:"",name:"min",required:!1,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/VNumberInput/index.tsx#VNumberInput"]={docgenInfo:VNumberInput.__docgenInfo,name:"VNumberInput",path:"src/VNumberInput/index.tsx#VNumberInput"})}catch(__react_docgen_typescript_loader_error){}var dist=__webpack_require__("./node_modules/@storybook/testing-library/dist/index.mjs");const index_stories={component:VNumberInput,argTypes:{}},Primary={render:args=>(0,jsx_runtime.jsx)(VNumberInput,{...args})},_123={name:"123",render:args=>{const[value,setValue]=(0,react.useState)(0);return(0,jsx_runtime.jsx)(VNumberInput,{...args,value,onInput:setValue})},play:async()=>{const el=document.querySelector("input");await dist.mV.type(el,"123"),el.blur()}},_2x3={name:"2 * 3",render:args=>{const[value,setValue]=(0,react.useState)(0);return(0,jsx_runtime.jsx)(VNumberInput,{...args,value,onInput:setValue})},play:async()=>{const el=document.querySelector("input");await dist.mV.type(el,"2 * 3"),el.blur()}};Primary.parameters={...Primary.parameters,docs:{...Primary.parameters?.docs,source:{originalSource:"{\n  render: args => {\n    return <VNumberInput {...args} />;\n  }\n}",...Primary.parameters?.docs?.source}}},_123.parameters={..._123.parameters,docs:{..._123.parameters?.docs,source:{originalSource:'{\n  name: "123",\n  render: args => {\n    const [value, setValue] = useState(0);\n    return <VNumberInput {...args} value={value} onInput={setValue} />;\n  },\n  play: async () => {\n    const el = document.querySelector("input")!;\n    await userEvent.type(el, "123");\n    el.blur();\n  }\n}',..._123.parameters?.docs?.source}}},_2x3.parameters={..._2x3.parameters,docs:{..._2x3.parameters?.docs,source:{originalSource:'{\n  name: "2 * 3",\n  render: args => {\n    const [value, setValue] = useState(0);\n    return <VNumberInput {...args} value={value} onInput={setValue} />;\n  },\n  play: async () => {\n    const el = document.querySelector("input")!;\n    await userEvent.type(el, "2 * 3");\n    el.blur();\n  }\n}',..._2x3.parameters?.docs?.source}}};const __namedExportsOrder=["Primary","_123","_2x3"]},"./src/styled/StyledInput.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>StyledInput});var styled_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_GlobalStyle__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/styled/GlobalStyle.tsx");const StyledInput=styled_components__WEBPACK_IMPORTED_MODULE_1__.ZP.input`
  display: block;
  color: var(--color-text);
  box-sizing: border-box;
  font-size: 12px;
  line-height: 12px;
  margin: 0;
  border: 1px solid var(${_GlobalStyle__WEBPACK_IMPORTED_MODULE_0__.Eu});
  background-color: var(${_GlobalStyle__WEBPACK_IMPORTED_MODULE_0__.Il});
  border-radius: 8px;
  height: 16px;
  padding-left: 8px;
  caret-color: red;
  max-width: 128px;

  :focus {
    outline: none;
    border-radius: 8px;
    background-color: var(${_GlobalStyle__WEBPACK_IMPORTED_MODULE_0__.sO});
  }

  font-family: "Ricty Diminished";
`;try{StyledInput.displayName="StyledInput",StyledInput.__docgenInfo={description:"",displayName:"StyledInput",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLInputElement | null) => void) | RefObject<HTMLInputElement> | null"}},theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"any"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"undefined"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/styled/StyledInput.tsx#StyledInput"]={docgenInfo:StyledInput.__docgenInfo,name:"StyledInput",path:"src/styled/StyledInput.tsx#StyledInput"})}catch(__react_docgen_typescript_loader_error){}},"./src/utils/getDragHander.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{j:()=>getDragHander,z:()=>useDragHandler});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function useDragHandler(cb,onDown,onUp){return(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>getDragHander(cb,onDown,onUp)),[cb,onDown,onUp])}function getDragHander(cb,onDown,onUp){return downEvent=>{const pass=onDown?.({startX:0,startY:0,diffX:0,diffY:0,startEvent:downEvent.nativeEvent,event:downEvent.nativeEvent});downEvent.stopPropagation();const startX=downEvent.clientX,startY=downEvent.clientY;let movePass;const handleMouseMove=e=>{const diffX=e.clientX-startX,diffY=e.clientY-startY;movePass=cb({startX,startY,diffX,diffY,startEvent:downEvent.nativeEvent,pass,event:e})},handleMouseUp=e=>{const diffX=e.clientX-startX,diffY=e.clientY-startY;onUp?.({startX,startY,diffX,diffY,startEvent:e,pass,movePass,event:e}),window.removeEventListener("mousemove",handleMouseMove),window.removeEventListener("mouseup",handleMouseUp)};window.addEventListener("mousemove",handleMouseMove),window.addEventListener("mouseup",handleMouseUp)}}},"./src/utils/useNativeOnChange.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>useNativeOnChange});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function useNativeOnChange(propsValue,propsOnChange){const inputRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),[value,setValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(propsValue);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const onChange=e=>{const target=e.target;propsOnChange?.(target.value)};inputRef.current&&inputRef.current.addEventListener("change",onChange);const el=inputRef.current;return()=>{el?.removeEventListener("change",onChange)}}),[propsOnChange,propsValue]),{inputRef,value,setValue}}},"?4f7e":()=>{}}]);
//# sourceMappingURL=VNumberInput-index-stories.0999afef.iframe.bundle.js.map